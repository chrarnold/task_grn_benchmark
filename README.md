# GRN benchmark


<!--
This file is automatically generated from the tasks's api/*.yaml files.
Do not edit this file directly.
-->

Benchmarking performance of GRN infernce methods.

Path to source:
[`src`](https://github.com/openproblems-bio/task_grn_benchmark/tree/main/src)

## README

## Installation

You need to have Docker, Java, and Viash installed. Follow [these
instructions](https://openproblems.bio/documentation/fundamentals/requirements)
to install the required dependencies.

## Add a method

To add a method to the repository, follow the instructions in the
`scripts/add_a_method.sh` script.

## Frequently used commands

To get started, you can run the following commands:

``` bash
git clone git@github.com:openproblems-bio/task_grn_benchmark.git

cd task_grn_benchmark

# download resources
scripts/download_resources.sh
```

To run the benchmark, you first need to build the components.
Afterwards, you can run the benchmark:

``` bash
viash ns build --parallel --setup cachedbuild

scripts/run_benchmark.sh
```

After adding a component, it is recommended to run the tests to ensure
that the component is working correctly:

``` bash
viash ns test --parallel
```

Optionally, you can provide the `--query` argument to test only a subset
of components:

``` bash
viash ns test --parallel --query "component_name"
```

## Motivation

Coming soon.

## Description

coming soon

## Authors & contributors

| name              | roles  |
|:------------------|:-------|
| Jalil Nourisa     | author |
| Robrecht Cannoodt | author |

## API

``` mermaid
flowchart LR
  file_perturbation_h5ad("perturbation")
  comp_control_method[/"Control Method"/]
  comp_metric[/"Label"/]
  file_prediction("GRN")
  file_score("Score")
  file_prior("prior data")
  file_multiomics_rna_h5ad("multiomics rna")
  comp_method[/"Method"/]
  file_multiomics_atac_h5ad("multiomics atac")
  file_perturbation_h5ad---comp_control_method
  file_perturbation_h5ad---comp_metric
  comp_control_method-->file_prediction
  comp_metric-->file_score
  file_prediction---comp_metric
  file_prior---comp_control_method
  file_multiomics_rna_h5ad---comp_method
  comp_method-->file_prediction
  file_multiomics_atac_h5ad---comp_method
```

## File format: perturbation

Perturbation dataset for benchmarking.

Example file: `resources/grn-benchmark/perturbation_data.h5ad`

Format:

<div class="small">

    AnnData object
     obs: 'cell_type', 'sm_name', 'donor_id', 'plate_name', 'row', 'well', 'cell_count'
     layers: 'n_counts', 'pearson', 'lognorm'

</div>

Slot description:

<div class="small">

| Slot | Type | Description |
|:---|:---|:---|
| `obs["cell_type"]` | `string` | The annotated cell type of each cell based on RNA expression. |
| `obs["sm_name"]` | `string` | The primary name for the (parent) compound (in a standardized representation) as chosen by LINCS. This is provided to map the data in this experiment to the LINCS Connectivity Map data. |
| `obs["donor_id"]` | `string` | Donor id. |
| `obs["plate_name"]` | `string` | Plate name 6 levels. |
| `obs["row"]` | `string` | Row name on the plate. |
| `obs["well"]` | `string` | Well name on the plate. |
| `obs["cell_count"]` | `string` | Number of single cells pseudobulked. |
| `layers["n_counts"]` | `double` | Pseudobulked values using mean approach. |
| `layers["pearson"]` | `double` | Normalized values using pearson residuals. |
| `layers["lognorm"]` | `double` | Normalized values using shifted logarithm . |

</div>

## Component type: Control Method

Path:
[`src/control_methods`](https://github.com/openproblems-bio/openproblems-v2/tree/main/src/control_methods)

A control method.

Arguments:

<div class="small">

| Name | Type | Description |
|:---|:---|:---|
| `--perturbation_data` | `file` | Perturbation dataset for benchmarking. |
| `--layer` | `string` | Which layer of pertubation data to use to find tf-gene relationships. Default: `lognorm`. |
| `--prior_data` | `file` | Prior data used for grn benchmark. |
| `--prediction` | `file` | (*Output*) GRN prediction. |

</div>

## Component type: Label

Path:
[`src/metrics`](https://github.com/openproblems-bio/openproblems-v2/tree/main/src/metrics)

A metric to evaluate the performance of the inferred GRN

Arguments:

<div class="small">

| Name | Type | Description |
|:---|:---|:---|
| `--perturbation_data` | `file` | Perturbation dataset for benchmarking. |
| `--layer` | `string` | (*Optional*) Which layer of pertubation data to use to find tf-gene relationships. Default: `lognorm`. |
| `--prediction` | `file` | GRN prediction. |
| `--score` | `file` | (*Output*) File indicating the score of a metric. |
| `--reg_type` | `string` | (*Optional*) name of regretion to use. Default: `ridge`. |
| `--subsample` | `integer` | (*Optional*) number of samples randomly drawn from perturbation data. Default: `-1`. |

</div>

## File format: GRN

GRN prediction

Example file: `resources/grn-benchmark/collectri.csv`

Format:

<div class="small">

    Tabular data
     'source', 'target', 'weight'

</div>

Slot description:

<div class="small">

| Column   | Type     | Description           |
|:---------|:---------|:----------------------|
| `source` | `string` | Source of regulation. |
| `target` | `string` | Target of regulation. |
| `weight` | `float`  | Weight of regulation. |

</div>

## File format: Score

File indicating the score of a metric.

Example file: `resources/grn-benchmark/score.csv`

Format:

<div class="small">

    Tabular data
     'accuracy', 'completeness'

</div>

Slot description:

<div class="small">

| Column         | Type     | Description                    |
|:---------------|:---------|:-------------------------------|
| `accuracy`     | `string` | (*Optional*) some explanation. |
| `completeness` | `double` | (*Optional*) some explanation. |

</div>

## File format: prior data

Prior data used for grn benchmark

Example file: `resources/grn-benchmark/prior_data.h5ad`

Format:

<div class="small">

    AnnData object
     uns: 'tf_list'

</div>

Slot description:

<div class="small">

| Slot | Type | Description |
|:---|:---|:---|
| `uns["tf_list"]` | `list` | List of known tfs obtained from https://resources.aertslab.org/cistarget. |

</div>

## File format: multiomics rna

RNA expression for multiomics data.

Example file: `resources/grn-benchmark/multiomics_rna.h5ad`

Format:

<div class="small">

    AnnData object
     obs: 'cell_type', 'donor_id'

</div>

Slot description:

<div class="small">

| Slot | Type | Description |
|:---|:---|:---|
| `obs["cell_type"]` | `string` | The annotated cell type of each cell based on RNA expression. |
| `obs["donor_id"]` | `string` | Donor id. |

</div>

## Component type: Method

Path:
[`src/methods`](https://github.com/openproblems-bio/openproblems-v2/tree/main/src/methods)

A GRN inference method

Arguments:

<div class="small">

| Name                | Type   | Description                                 |
|:--------------------|:-------|:--------------------------------------------|
| `--multiomics_rna`  | `file` | RNA expression for multiomics data.         |
| `--multiomics_atac` | `file` | (*Optional*) Peak data for multiomics data. |
| `--prediction`      | `file` | (*Output*) GRN prediction.                  |

</div>

## File format: multiomics atac

Peak data for multiomics data.

Example file: `resources/grn-benchmark/multiomics_atac.h5ad`

Format:

<div class="small">

    AnnData object
     obs: 'cell_type', 'donor_id'

</div>

Slot description:

<div class="small">

| Slot | Type | Description |
|:---|:---|:---|
| `obs["cell_type"]` | `string` | The annotated cell type of each cell based on RNA expression. |
| `obs["donor_id"]` | `string` | Donor id. |

</div>

